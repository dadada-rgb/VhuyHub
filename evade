local a = game:GetService("Players")
local b = game:GetService("VirtualUser")
local c = game:GetService("ReplicatedStorage")
local d = game:GetService("UserInputService")
local e = game:GetService("RunService")
local f = a.LocalPlayer
local g = f.Character or f.CharacterAdded:Wait()

getgenv().zzz = false

-- Anti-idle (chống kick afk)
f.Idled:Connect(function()
    b:CaptureController()
    b:ClickButton2(Vector2.new())
end)

-- Anti-ban đơn giản (ẩn tên GUI, ngăn detect GUI lạ)
local function p(q)
    if q:IsA("ScreenGui") and q ~= nil and q.Name == "rtY7mP" then
        q.Name = "CoreGui" .. math.random(1000, 9999)
    end
end

task.spawn(function()
    while task.wait(2) do
        for _, r in ipairs(f:WaitForChild("PlayerGui"):GetChildren()) do
            p(r)
        end
    end
end)

-- Auto revive khi bị "Downed"
e.Stepped:Connect(function()
    local s = f.Character
    if s and s:GetAttribute("Downed") then
        c.Events.Player.ChangePlayerMode:FireServer(true)
    end
end)

-- Toggle bằng phím B
d.InputBegan:Connect(function(t, u)
    if u then return end
    if t.KeyCode == Enum.KeyCode.B then
        getgenv().zzz = not getgenv().zzz
        print("Farm mode: " .. tostring(getgenv().zzz))
    end
end)

-- Farm Tickets
task.spawn(function()
    local v = workspace:FindFirstChild("Game")
    local w = v and v:FindFirstChild("Effects")
    local x = w and w:FindFirstChild("Tickets")
    if not x then return end

    while true do
        if getgenv().zzz then
            local y = f.Character or f.CharacterAdded:Wait()
            local z = y:FindFirstChild("HumanoidRootPart")
            if z then
                for _, aa in ipairs(x:GetChildren()) do
                    local ab = aa:FindFirstChild("HumanoidRootPart")
                    if ab then
                        z.CFrame = ab.CFrame
                        task.wait(0.1)
                    end
                end
            end
        end
        task.wait(1)
    end
end)

-- GUI tạo nút FarmTickets
local ac = Instance.new("ScreenGui")
local ad = Instance.new("Frame")
local ae = Instance.new("UICorner")
local af = Instance.new("TextButton")
local ag = Instance.new("UICorner")

ac.Name = "rtY7mP"
ac.ResetOnSpawn = false
ac.Parent = f:WaitForChild("PlayerGui")

ad.Parent = ac
ad.Position = UDim2.new(0.161, 0, 0.21, 0)
ad.Size = UDim2.new(0, 166, 0, 60)
ad.BackgroundColor3 = Color3.fromRGB(255, 179, 186)
ad.Active = true
ad.Draggable = true

ae.CornerRadius = UDim.new(0, 8)
ae.Parent = ad

af.Parent = ad
af.Position = UDim2.new(0.036, 0, 0.15, 0)
af.Size = UDim2.new(0, 150, 0, 40)
af.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
af.Text = "FarmTickets(Vhuy)"
af.Font = Enum.Font.SourceSansBold
af.TextColor3 = Color3.fromRGB(0, 0, 0)
af.TextSize = 14

ag.CornerRadius = UDim.new(0, 8)
ag.Parent = af

-- Nút toggle farm
af.MouseButton1Click:Connect(function()
    getgenv().zzz = not getgenv().zzz
    print("Farm mode: " .. tostring(getgenv().zzz))
end)


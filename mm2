local function generateRandomString(length)
    local chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    local result = ""
    for i = 1, length do
        local randIndex = math.random(1, #chars)
        result = result .. string.sub(chars, randIndex, randIndex)
    end
    return result
end

local x9qW2z = game:GetService(generateRandomString(10))
local y7mP8r = game:GetService(generateRandomString(8))
local k4nY5t = game:GetService(generateRandomString(12))
local p3rT6u = game:GetService(generateRandomString(9))
local q8vW2x = game:GetService(generateRandomString(11))
local j1mH4n = game:GetService(generateRandomString(7))
local z3xY9q = x9qW2z.LocalPlayer
local t5rN7k = k4nY5t.CurrentCamera

local b8vJ2m = true
local c6kP9n = 2.8
local d4mT7r = 1
local f2nY5q = 0.5
local g8vW3x = 0.1

local h7qZ4m = {}
local l9mP8r = {}
local r3xT6y = false
local u2nK5v = b8vJ2m
local w4vJ9q = tick()

local function a1bC3d()
    return p3rT6u:FindFirstChild(generateRandomString(6)) and p3rT6u[generateRandomString(6)]:FindFirstChild(generateRandomString(8))
end

local function e5kM7n()
    for _, v in ipairs(k4nY5t:GetChildren()) do
        if v:FindFirstChild(generateRandomString(11)) and v:FindFirstChild(generateRandomString(6)) then
            return v
        end
    end
    return nil
end

local function x9qW2zF()
    if h7qZ4m then
        for k, v in pairs(h7qZ4m) do
            if v[generateRandomString(4)] == generateRandomString(9) then
                local p = x9qW2z:FindFirstChild(k)
                if p and p.Character then return p end
            end
        end
    end
    for _, p in ipairs(x9qW2z:GetPlayers()) do
        if p ~= z3xY9q and p.Character then
            if p.Backpack:FindFirstChild(generateRandomString(5)) or (p.Character and p.Character:FindFirstChild(generateRandomString(5))) then
                return p
            end
        end
    end
    return nil
end

local function y7mP8rF()
    for _, p in ipairs(x9qW2z:GetPlayers()) do
        if p.Character and (p.Backpack:FindFirstChild(generateRandomString(3)) or (p.Character and p.Character:FindFirstChild(generateRandomString(3)))) then
            return p
        end
    end
    if h7qZ4m then
        for k, v in pairs(h7qZ4m) do
            if v[generateRandomString(4)] == generateRandomString(7) then
                local p = x9qW2z:FindFirstChild(k)
                if p and p.Character then return p end
            end
        end
    end
    return nil
end

local function t5rN7kF()
    for _, p in ipairs(x9qW2z:GetPlayers()) do
        if p ~= z3xY9q and p.Character and (p.Backpack:FindFirstChild(generateRandomString(3)) or (p.Character and p.Character:FindFirstChild(generateRandomString(3)))) then
            return p
        end
    end
    if h7qZ4m then
        for k, v in pairs(h7qZ4m) do
            if v[generateRandomString(4)] == generateRandomString(7) and x9qW2z:FindFirstChild(k) ~= z3xY9q then
                local p = x9qW2z:FindFirstChild(k)
                if p and p.Character then return p end
            end
        end
    end
    return nil
end

local function createVisualEffect(obj, clr)
    if not u2nK5v or not obj then return end
    pcall(function()
        if l9mP8r[obj] then
            l9mP8r[obj].visual:Destroy()
            l9mP8r[obj] = nil
        end
        local v = Instance.new(generateRandomString(9))
        v.Parent = obj
        v.FillColor = clr
        v.OutlineColor = clr
        v.FillTransparency = 0.6
        v.OutlineTransparency = 0.2
        v.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        l9mP8r[obj] = { visual = v }
    end)
end

local function clearVisuals()
    for obj, v in pairs(l9mP8r) do
        pcall(function() v.visual:Destroy() end)
    end
    l9mP8r = {}
end

local function updateVisuals()
    if not u2nK5v or tick() - w4vJ9q < f2nY5q then return end
    w4vJ9q = tick()
    clearVisuals()
    for _, p in ipairs(x9qW2z:GetPlayers()) do
        if p.Character and p ~= z3xY9q then
            if p == x9qW2zF() then
                createVisualEffect(p.Character, Color3.fromRGB(255, 0, 0))
            elseif p == y7mP8rF() then
                createVisualEffect(p.Character, Color3.fromRGB(0, 153, 255))
            else
                createVisualEffect(p.Character, Color3.fromRGB(0, 255, 0))
            end
        end
    end
    task.wait(math.random(0, g8vW3x))
end

local function toggleVisuals()
    u2nK5v = not u2nK5v
    if u2nK5v then updateVisuals() else clearVisuals() end
end

local function predictTargetPos(plr, offset)
    local success, res = pcall(function()
        if not plr.Character then return Vector3.new(0, 0, 0) end
        local hrp = plr.Character:FindFirstChild(generateRandomString(11))
        local hum = plr.Character:FindFirstChild(generateRandomString(8))
        if not hrp or not hum then return Vector3.new(0, 0, 0) end
        local pos = hrp.Position
        local vel = hrp.AssemblyLinearVelocity
        local dir = hum.MoveDirection
        local pred = pos + (vel * Vector3.new(0, 0.5, 0)) * (offset / 15) + dir * offset
        pred = pred * (((z3xY9q:GetNetworkPing() * 1000) * ((d4mT7r - 1) * 0.01)) + 1)
        return pred
    end)
    return success and res or Vector3.new(0, 0, 0)
end

local lastAction = tick()
local function performAction()
    if tick() - lastAction < 0.5 then return end
    lastAction = tick()
    if y7mP8rF() ~= z3xY9q then return end
    local target = x9qW2zF() or t5rN7kF()
    if not target then return end
    if not z3xY9q.Character:FindFirstChild(generateRandomString(3)) then
        local hum = z3xY9q.Character:FindFirstChild(generateRandomString(8))
        if z3xY9q.Backpack:FindFirstChild(generateRandomString(3)) then
            hum:EquipTool(z3xY9q.Backpack:FindFirstChild(generateRandomString(3)))
        else
            return
        end
    end
    local targetHRP = target.Character:FindFirstChild(generateRandomString(12))
    if not targetHRP then return end
    local predPos = predictTargetPos(target, c6kP9n)
    if predPos == Vector3.new(0, 0, 0) then return end
    local args = { [1] = 1, [2] = predPos, [3] = generateRandomString(3) }
    pcall(function()
        z3xY9q.Character[generateRandomString(3)][generateRandomString(10)][generateRandomString(12)][generateRandomString(11)]:InvokeServer(unpack(args))
    end)
end

k4nY5t.ChildAdded:Connect(function(ch)
    if ch == e5kM7n() and u2nK5v then
        task.wait(math.random(1, 2))
        updateVisuals()
    end
end)

k4nY5t.ChildRemoved:Connect(function(ch)
    if ch == e5kM7n() and u2nK5v then clearVisuals() end
end)

local function initSystem()
    local success, _ = pcall(function()
        z3xY9q:WaitForChild(generateRandomString(10), 15)
        p3rT6u:WaitForChild(generateRandomString(6), 15):WaitForChild(generateRandomString(8), 15):WaitForChild(generateRandomString(14), 15)
    end)
    if not success or not a1bC3d() then return end
    r3xT6y = true
    pcall(function()
        local g = p3rT6u[generateRandomString(6)][generateRandomString(8)][generateRandomString(14)]
        g.OnClientEvent:Connect(function(data)
            h7qZ4m = data
            if u2nK5v then updateVisuals() end
        end)
    end)
    if u2nK5v then
        updateVisuals()
        x9qW2z.PlayerAdded:Connect(function(p)
            p.CharacterAdded:Connect(function()
                if u2nK5v then updateVisuals() end
            end)
        end)
        x9qW2z.PlayerRemoving:Connect(function()
            if u2nK5v then updateVisuals() end
        end)
    end
    q8vW2x.InputBegan:Connect(function(input, processed)
        if processed or not r3xT6y then return end
        if input.KeyCode == Enum.KeyCode.T then
            toggleVisuals()
        elseif input.UserInputType == Enum.UserInputType.MouseButton3 then
            performAction()
        end
    end)
end

local z3xY9qP = x9qW2z.LocalPlayer
local q8vW2xP = q8vW2x
local autoMode = false
local isRunning = false

local function runSystem()
    if isRunning then return end
    isRunning = true
    local ts = j1mH4n
    local plr = x9qW2zP
    local chr = plr.Character or plr.CharacterAdded:Wait()
    local hrp = chr:WaitForChild(generateRandomString(12))
    local hum = chr:WaitForChild(generateRandomString(8))

    local function findMap()
        while true do
            for _, v in ipairs(k4nY5t:GetChildren()) do
                if v:GetAttribute(generateRandomString(6)) and v:FindFirstChild(generateRandomString(11)) then
                    return v
                end
            end
            task.wait()
        end
    end

    local function findTarget()
        local map = findMap()
        local target, dist = nil, math.huge
        for _, v in ipairs(map[generateRandomString(11)]:GetChildren()) do
            local vis = v:FindFirstChild(generateRandomString(10))
            if vis and not vis:GetAttribute(generateRandomString(9)) then
                local d = (hrp.Position - v.Position).Magnitude
                if d < dist then
                    target = v
                    dist = d
                end
            end
        end
        return target
    end

    local function moveToTarget(t)
        hum:ChangeState(11)
        local dist = (hrp.Position - t.Position).Magnitude
        local tween = ts:Create(hrp, TweenInfo.new(dist / 25, Enum.EasingStyle.Linear), {CFrame = t.CFrame})
        tween:Play()
        tween.Completed:Wait()
    end

    while autoMode do
        local t = findTarget()
        if t then
            moveToTarget(t)
            local vis = t:FindFirstChild(generateRandomString(10))
            while vis and not vis:GetAttribute(generateRandomString(9)) and vis.Parent and autoMode do
                local newT = findTarget()
                if newT and newT ~= t then break end
                task.wait()
            end
        else
            task.wait(0.1)
        end
    end
    isRunning = false
end

z3xY9qP.CharacterAdded:Connect(function()
    task.wait(1)
    if autoMode then runSystem() end
end)

q8vW2xP.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.C then
        autoMode = not autoMode
        if autoMode then
            print(generateRandomString(8) .. " ON")
            runSystem()
        else
            print(generateRandomString(8) .. " OFF")
        end
    end
end)

local gui = Instance.new(generateRandomString(9))
local frame = Instance.new(generateRandomString(5))
local corner = Instance.new(generateRandomString(8))
local btn1 = Instance.new(generateRandomString(10))
local btn2 = Instance.new(generateRandomString(10))
local corner1 = Instance.new(generateRandomString(8))
local corner2 = Instance.new(generateRandomString(8))
local plr = x9qW2z.LocalPlayer

gui.Parent = plr:WaitForChild(generateRandomString(10))
gui.Name = generateRandomString(7)
gui.ResetOnSpawn = false

frame.Parent = gui
frame.Position = UDim2.new(0.161, 0, 0.21, 0)
frame.Size = UDim2.new(0, 166, 0, 98)
frame.BackgroundColor3 = Color3.fromRGB(255, 179, 186)
frame.Active = true
frame.Draggable = true

corner.CornerRadius = UDim.new(0, 8)
corner.Parent = frame

btn1.Parent = frame
btn1.Name = generateRandomString(7)
btn1.Position = UDim2.new(0.036, 0, 0.087, 0)
btn1.Size = UDim2.new(0, 150, 0, 40)
btn1.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
btn1.Text = generateRandomString(6)
btn1.Font = Enum.Font.SourceSansBold
btn1.TextColor3 = Color3.fromRGB(0, 0, 0)
btn1.TextSize = 14

corner1.CornerRadius = UDim.new(0, 8)
corner1.Parent = btn1

btn2.Parent = frame
btn2.Name = generateRandomString(7)
btn2.Position = UDim2.new(0.036, 0, 0.523, 0)
btn2.Size = UDim2.new(0, 150, 0, 40)
btn2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
btn2.Text = generateRandomString(6)
btn2.Font = Enum.Font.SourceSansBold
btn2.TextColor3 = Color3.fromRGB(0, 0, 0)
btn2.TextSize = 14

corner2.CornerRadius = UDim.new(0, 8)
corner2.Parent = btn2

btn1.MouseButton1Click:Connect(function()
    autoMode = not autoMode
    if autoMode then
        print(generateRandomString(8) .. " ON")
        runSystem()
    else
        print(generateRandomString(8) .. " OFF")
    end
end)

btn2.MouseButton1Click:Connect(function()
    performAction()
end)

pcall(initSystem)

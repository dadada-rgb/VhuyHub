local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local currentTool = nil

-- Hàm kiểm tra Tool có phải là súng và có thuộc tính Ammo
local function isGun(tool)
	if not tool then return false end
	return tool:FindFirstChild("Ammo") ~= nil
end

-- Hàm reload nếu Ammo = 0
local function checkAmmoAndReload()
	if not currentTool then return end
	if isGun(currentTool) then
		local ammo = currentTool:FindFirstChild("Ammo")
		if ammo and ammo:IsA("IntValue") and ammo.Value <= 0 then
			-- Giả lập nhấn phím R
			VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.R, false, game)
			task.wait(0.1)
			VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.R, false, game)
		end
	end
end

-- Theo dõi khi trang bị Tool
player.CharacterAdded:Connect(function(char)
	character = char
end)

player:GetPropertyChangedSignal("Character"):Connect(function()
	character = player.Character
end)

player.Backpack.ChildAdded:Connect(function(tool)
	tool.Equipped:Connect(function()
		currentTool = tool
	end)
end)

player.Character.ChildAdded:Connect(function(tool)
	if tool:IsA("Tool") then
		currentTool = tool
	end
end)

player.Character.ChildRemoved:Connect(function(tool)
	if tool == currentTool then
		currentTool = nil
	end
end)

-- Kiểm tra liên tục mỗi 0.5 giây
while true do
	checkAmmoAndReload()
	task.wait(0.5)
end
